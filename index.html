<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>HealingLensStudio Calm</title>

  <style>
    body {
      font-family: 'Libre Baskerville', serif;
      background: linear-gradient(135deg,#f5f1ec,#e6f0ec,#fdfcfa);
      color:#2E2E2E;
      margin:0; padding:20px;
      display:flex; flex-direction:column; align-items:center;
      text-align:center;
    }
    h1 { font-family:'Poppins',sans-serif; margin:10px 0 4px; font-size:1.8rem; }
    h2 { font-style:italic; margin:0 0 12px; color:#666; }
    .prompt-box {
      background:#fff; border-radius:14px; padding:20px;
      max-width:600px; margin:10px 0;
      box-shadow:0 6px 20px rgba(0,0,0,0.08);
      text-align:left; white-space:pre-wrap;
    }
    .prompt { font-size:1.2rem; line-height:1.7; }
    .controls { display:flex; flex-wrap:wrap; gap:10px; justify-content:center; margin:12px 0; }
    button {
      padding:10px 16px; border:none; border-radius:12px;
      font-size:1rem; cursor:pointer;
      font-family:'Poppins',sans-serif;
      background:#EED9D0; transition:background 0.3s;
    }
    button:hover { background:#D5E0D5; }
    select { border-radius:10px; padding:8px 12px; font-size:1rem; }
    .breathe-circle {
      width:120px; height:120px;
      border-radius:50%; background:#EED9D0;
      margin:20px auto; display:none; opacity:0;
    }
    @keyframes breatheSimple {
      0% { transform:scale(1); }
      50% { transform:scale(1.6); }
      100% { transform:scale(1); }
    }
    .breathing-simple {
      animation: breatheSimple 6000ms ease-in-out 4 forwards;
      opacity:1 !important;
    }
    #toast {
      position:fixed; left:50%; bottom:22px;
      transform:translateX(-50%);
      background:rgba(0,0,0,0.8); color:#fff;
      padding:8px 12px; border-radius:8px;
      display:none; font-size:0.95rem;
    }
    .footer { font-size:0.9rem; margin-top:20px; font-style:italic; color:#666; }
  </style>
</head>
<body>
  <h1>HealingLensStudio Calm</h1>
  <h2>For the Quiet in You üåø</h2>

  <div class="controls">
    <label><input type="radio" name="mode" value="prompt" checked> Prompts</label>
    <label><input type="radio" name="mode" value="affirmation"> Affirmations</label>
    <select id="category">
      <option value="mindfulness">üåø Mindfulness</option>
      <option value="movement">‚ú® Movement</option>
      <option value="kindness">üíõ Kindness</option>
      <option value="creativity">üé® Creativity</option>
    </select>
  </div>

  <div class="prompt-box"><p id="prompt" class="prompt">‚ú® Loading‚Ä¶</p></div>

  <div class="controls">
    <button id="newBtn">üå∏ New</button>
    <button id="copyBtn">üìã Copy</button>
    <button id="shareBtn">üì§ Share</button>
    <button id="favBtn">‚≠ê Favorite</button>
  </div>

  <h3>Breathe With Me</h3>
  <div class="breathe-circle" id="breathe-circle"></div>
  <button id="startBreath">‚ñ∂ Start</button>

  <div class="footer">HealingLensStudio | For the Quiet in You</div>
  <div id="toast"></div>

  <script>
    // --- Library (30 each)
    const LIB = { /* same 30 prompts + affirmations as before */ };

    let prompts = LIB.prompts, affirmations = LIB.affirmations;
    let favorites = JSON.parse(localStorage.getItem('favorites')||'[]');
    const lastPromptByCategory = {};
    let breathTimeout=null;

    function showToast(msg,ms=1500){
      const t=document.getElementById('toast');
      t.textContent=msg; t.style.display='block';
      clearTimeout(window.toastTimer);
      window.toastTimer=setTimeout(()=>t.style.display='none',ms);
    }

    function newPrompt(){
      const cat=document.getElementById('category').value;
      const mode=document.querySelector('input[name="mode"]:checked').value;
      const set=(mode==='prompt'?prompts:affirmations)[cat];
      if(!set||!set.length){document.getElementById('prompt').innerText='No items.';return;}
      let idx; do{idx=Math.floor(Math.random()*set.length);}while(idx===lastPromptByCategory[cat]&&set.length>1);
      lastPromptByCategory[cat]=idx;
      const text=set[idx]+(mode==='prompt'?"\n\nüåø Breathe this in. Try writing one line in your journal.":"");
      document.getElementById('prompt').innerText=text;
    }

    async function copyPrompt(){
      try{await navigator.clipboard.writeText(document.getElementById('prompt').innerText);showToast('Copied!');}
      catch(e){showToast('Copy failed');}
    }

    async function sharePrompt(){
      const text=document.getElementById('prompt').innerText.trim();
      if(!text)return;
      if(navigator.share){try{await navigator.share({title:'HealingLensStudio Calm',text});showToast('Shared');return;}catch{}}
      try{await navigator.clipboard.writeText(text);showToast('Copied (no share)');}catch{showToast('Failed');}
    }

    function addFavorite(){
      const t=document.getElementById('prompt').innerText;
      if(!t)return;
      if(!favorites.includes(t)){favorites.push(t);localStorage.setItem('favorites',JSON.stringify(favorites));showToast('Saved!');}
      else showToast('Already saved');
    }

    function startBreathing(){
      const circle=document.getElementById('breathe-circle');
      circle.style.display='block'; circle.style.opacity='1';
      circle.classList.remove('breathing-simple');
      if(breathTimeout){clearTimeout(breathTimeout);}
      void circle.offsetWidth; // restart
      circle.classList.add('breathing-simple');
      showToast('ü´Å Inhale‚Ä¶ Exhale‚Ä¶');
      breathTimeout=setTimeout(()=>{
        circle.classList.remove('breathing-simple');
        circle.style.opacity='0';
        setTimeout(()=>circle.style.display='none',200);
        showToast('Breathing complete');
      },6000*4+100);
    }

    document.getElementById('newBtn').addEventListener('click',newPrompt);
    document.getElementById('copyBtn').addEventListener('click',copyPrompt);
    document.getElementById('shareBtn').addEventListener('click',sharePrompt);
    document.getElementById('favBtn').addEventListener('click',addFavorite);
    document.getElementById('startBreath').addEventListener('click',startBreathing);
    document.getElementById('category').addEventListener('change',newPrompt);
    document.querySelectorAll('input[name="mode"]').forEach(r=>r.addEventListener('change',newPrompt));

    window.onload=newPrompt;
  </script>
</body>
</html>
